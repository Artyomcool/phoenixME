<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>

           
 

 <style type="text/css"> 
<!-- /* <![CDATA[ */
@import "/branding/css/tigris.css";
@import "/inst.css"; 
 

 /* ]]> */
 --> 

 </style>
 <link rel="stylesheet" type="text/css" href="how-to2_files/print.html" media="print">
 <script src="how-to2_files/tigris.html" type="text/javascript"></script>
 <!-- ------- ORIGINAL CODE --------------------------- -->
 <!--<head>
 <style type="text/css"> 
 /* <![CDATA[ */
 @import "/branding/css/tigris.css";
 @import "/branding/css/inst.css";
 /* ]]> */
 </style>
 <link rel="stylesheet" type="text/css" href="/branding/css/print.css" media="print" />
 <script src="/branding/scripts/tigris.js" type="text/javascript"></script> -->


  
                                                     <title>Getting Started: Build Host Environment</title>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <meta http-equiv="Content-Style-Type" content="text/css" />
 <meta name="version" content="3.5.1.19.8" />
 <style type="text/css">
<!--
a:link {
	text-decoration: none;
}
a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: underline;
}
a:active {
	text-decoration: none;
}
-->
</style></head>
 
 
<body  class="composite">
  
<table border="0" cellspacing="0" cellpadding="4" width="100%" id="main">
<tr>
 <td id="midcol">
 
 
<!-- 
 ===============================================================================
    IGNORE EVERYTHING ABOVE THIS AREA.  *   START EDITING BELOW 
 ===============================================================================
 -->
 
 
 
<!--BEGIN * PAGE TITLE -->
<div id="projecthome" class="app"> 
<h1><font color="#E76F00">CDC Build System: Host Environment</font></h1>
<!--END * PAGE TITLE -->
<p>
Once you have downloaded the source code
for the <i>phoneME Advanced 1.0</i> Project,
you can use the build system included with it
to build different executable versions of a CDC Java runtime environment.
These different versions can include different peformance features,
API options or run on different target platforms.
</p><p>
The following sections show how to
setup the CDC build system on a Linux/x86 host platform,
and then build different versions of the CDC Java runtime environment 
that will also run on a Linux/x86 platform.
A later section describes how to build
different versions of the CDC Java runtime environment
that will also run on alternate devices like advanced phones.
</p><p>
    </p><ul>
    <p>
    </p><li><a href="#Setup">Build System Setup</a>
      <ul>
        <li><a href="#SetupLinuxPackages">Install the Linux Build Tool Packages</a>        </li>
        <li><a href="#SetupJavaTools">Install the Java Build Tools</a>        </li>
        <li><a href="#SetupLocateTools">Specify the Build Tool Locations</a>      </li>
      </ul>
    <p>
    </p></li><li><a href="#Simple">A Simple Example Build: CDC</a>
      <ul>
        <li><a href="#SimpleBuild">Build the Executable</a>        </li>
        <li><a href="#SimpleTest">Test the Executable</a>      </li>
      </ul>
    <p>
    </p></li><li><a href="#SimpleFP">Building Foundation Profile</a>
    <p>
    </p></li><li><a href="#BuildOptions">More Build Options</a>
    <p>
    </p></li><li><a href="#PBP">Building Personal Basis Profile</a>
      <ul>
        <li><a href="#PBPSetup">Setup the Build System</a>        </li>
        <li><a href="#PBPBuild">Build the Executable</a>
        </li><li><a href="#PBPTest">Test the Executable</a>
      </li></ul>
    <p>
    </p></li><li><a href="#PP">Building Personal Profile</a>
      <ul>
        <li><a href="#PPSetup">Setup the Build System</a>
        </li><li><a href="#PPBuild">Build the Executable</a>
        </li><li><a href="#PPTest">Test the Executable</a>
      </li></ul>
    </li></ul>
<p>
This guide only covers the basic build procedures and build options.
See the <i>CDC Build System Guide</i> for more information about build options,
build system organization and tool setup issues.
</p><p>
See <a href="/content/pmAdv-buildtarget.html">Target Devices</a>
for information on how to build executable versions
of the CDC Java runtime environment for various embedded target devices.

<hr size="1" noshade>
<a name="Setup"><h2>Build System Setup</h2></a>
</p><p>
<a name="SetupLinuxPackages"><h3>Install the Linux Build Tool Packages</h3></a>
</p><p>
The CDC build system included with the source code
for the <i>phoneME Advanced 1.0</i> Project
can run on many different Linux distributions.
To run the CDC build system,
you will need certain Linux developer tools like a C/C++ compiler
as well as Java developer tools included in the <a href="http://java.sun.com/j2se/1.4.2/download.html">Java SE SDK</a>.
</p><p>
A reasonable guideline is that a recent, common Linux distribution
should include tools recent enough to use with the CDC build system.
However for Linux distributions like <a href="http://www.ubuntu.com/">Ubuntu</a>
which don't include the necessary tools by default,
the table below provides guidelines for acquiring the necessary tools.
Linux distributions have a mechanism for deploying pre-built software
called a <a href="http://en.wikipedia.org/wiki/Package_management_system">
package management system</a>.
There are two main Linux package management systems:
</p><p>
</p><ul>
<li>
<a href="http://packages.debian.org/">
Debian Package Management System</a> used by
<a href="http://www.debian.org/">Debian</a>
and
<a href="http://www.ubuntu.com/">Ubuntu</a>.
<p>
</p></li><li>
<a href="http://www.rpm.org/">
Red Hat Package Management System</a> used by
<a href="http://www.opensuse.org/">openSUSE</a>
and
<a href="http://fedora.redhat.com/">Fedora</a>.
</li></ul>
<p>
The table below shows the packages needed by the CDC build system.
Note that these lists are really guidelines since we haven't been able
to test every conceivable tool combination.
</p><p>
</p><blockquote>
<table cellspacing="10">
<tbody><tr><th colspan="2"><b>Debian</b></th><th colspan="2"><b>RPM</b></th></tr>
<tr><th><b>Package</b></th><th><b>Version</b></th><th><b>Package</b></th><th><b>Version</b></th></tr>
<tr><td><tt>binutils-static</tt></td><td>2.16</td><td><tt>binutils</tt></td><td>?.?</td></tr>
<tr><td><tt>bison</tt></td><td>1:2.1</td><td><tt>bison</tt></td><td>?.?</td></tr>
<tr><td><tt>flex</tt></td><td>2.5.31</td><td><tt>flex</tt></td><td>?.?</td></tr>
<tr><td><tt>g++-3.4</tt></td><td>3.4.6</td><td><tt>g++-3.4</tt></td><td>?.?</td></tr>
<tr><td><tt>make</tt></td><td>3.8</td><td><tt>make</tt></td><td>?.?</td></tr>
<tr><td><tt>subversion</tt></td><td>1.3.1</td><td><tt>subversion</tt></td><td>?.?</td></tr>
</tbody></table>
</blockquote>

<a name="SetupJavaTools"><h3>Install the Java Build Tools</h3></a>
<p>
Download and install the
<a href="http://java.sun.com/j2se/1.4.2/download.html">Java SE SDK</a>,
version 1.4.2.
The examples below are based on installing the Java developer tools
in <tt>/usr/java/j2sdk</tt>.
</p><p>
Note that many Linux distributions include alternate implementations
of these Java developer tools.
We have only tested and run the CDC build system
with the Java developer tools provided by Sun.

<a name="SetupLocateTools"><h3>Specify the Build Tool Locations</h3></a>
</p><p>
After installing the necessary build tools
you'll need to specify their locations
so that the CDC build system can use them properly.
There are three categories of build tools
and the example below explicitly defines the location of each build tool.
</p><p>
</p><ul>
<li>
<b>Host build tools.</b>
These are compilers and utilities
for building internal tools and peforming internal build system processes.
For example,
the CDC build system includes the source code
for an internal build tool called <tt>JavaCodeCompact</tt>
and the <b>host build tools</b> (a C/C++ compiler) must build this tool.
<p>
</p></li><li>
<b>Target build tools.</b>
These are compilers and utilities
for building executables for the target device.
For the case of using a Linux/x86 development environment
to build a Linux/x86 version of the CDC Java runtime environment,
the host build tools are largely the same as the target build tools.
But for embedded devices,
target build tools may be provided
by third-party hardware vendors or partners.
<p>
</p></li><li>
<b>JDK tools.</b>
These are standard Java developer tools available in the 
<a href="http://java.sun.com/j2se/1.4.2/download.html">Java SE SDK</a>,
version 1.4.2.
</li></ul>
<p>
When you browse the <tt>build</tt> directory hierarchy,
you'll notice that it has a certain structure.
The <tt>shared</tt> directory contains lots of <tt>make</tt> scripts
which are shared by the entire CDC build system.
And there are target build directories like <tt>linux-x86-generic</tt>
that contain a <tt>GNUmakefile</tt> and perhaps some other files.
These target build directories are the starting point
for using the CDC build system.
</p><p>
</p><ol>
<li>
<b>Change the current directory to the target build directory.</b>
<p>
</p><blockquote>
<pre>% cd build/linux-x86-generic
</pre>
</blockquote>
<p>
</p></li><li>
<b>Use a text editor to edit the <tt>GNUmakefile</tt>.</b>
<p>
</p><blockquote>
<pre>% vi GNUmakefile
</pre>
</blockquote>
<p>
</p></li><li>
<b>Insert the following variable definitions
into the <tt>GNUmakefile</tt> in the target build directory.</b>
These <tt>make</tt> variables define the locations of each build tool.
The shared variables <tt>MY_HOST_TOOLS</tt>, <tt>MY_TARGET_TOOLS</tt> and <tt>MY_JAVA_TOOLS</tt>
may need different values to specify the location of these tools on your system.
<p>
</p><blockquote>
<pre>#
# Locate the host build tools:
#
MY_HOST_TOOLS = /usr/bin
HOST_CC             = $(MY_HOST_TOOLS)/gcc-3.4
HOST_CCC            = $(MY_HOST_TOOLS)/g++-3.4
ZIP                 = $(MY_HOST_TOOLS)/zip

#
# Locate the target build tools:
#
MY_TARGET_TOOLS = /usr/bin
TARGET_CC           = $(MY_TARGET_TOOLS)/gcc-3.4
TARGET_CCC          = $(MY_TARGET_TOOLS)/g++-3.4
TARGET_AS           = $(TARGET_CC)
TARGET_LD           = $(TARGET_CC)
TARGET_AR           = $(MY_TARGET_TOOLS)/ar
TARGET_RANLIB       = $(MY_TARGET_TOOLS)/ranlib

#
# Locate the JDK build tools:
#
MY_JAVA_TOOLS = /usr/java/j2sdk/bin
CVM_JAVA            = $(MY_JAVA_TOOLS)/java
CVM_JAVAC           = $(MY_JAVA_TOOLS)/javac
CVM_JAVAH           = $(MY_JAVA_TOOLS)/javah
CVM_JAR             = $(MY_JAVA_TOOLS)/jar
</pre>
</blockquote>
<p>
Note that on most systems,
the GCC excutable is named <tt>gcc</tt>,
but on systems like Ubuntu,
the excutable name may include a version number.
</p></li></ol>

<hr size="1" noshade>
<a name="Simple"><h2>A Simple Example Build: CDC</h2></a>
<p>
Once you've set up the CDC build system
by installing the necessary build tools
and specifying their location in the <tt>GNUmakefile</tt>,
then you can perform a simple build process
to validate the build system.
</p><p>
The simplest build target is CDC without any profile.
This is a "headless" implementation
that we'll use to run a basic <tt>HelloWorld</tt> application.

<a name="SimpleBuild"><h3>Build the Executable</h3></a>
</p><p>
The CDC build system is launched with a single <tt>make</tt> command.
</p><p>
</p><blockquote>
<pre>% make
</pre>
</blockquote>
<p>
The build system will display a log of the build process.
If the build is successful, it will display something like:
</p><p>
</p><blockquote>
<pre>...
make[1]: Entering directory `/home/user/monaco-oss/build/linux-x86-ubuntu'
make[1]: Nothing to be done for `tools'.
make[1]: Leaving directory `/home/user/monaco-oss/build/linux-x86-ubuntu'
</pre>
</blockquote>
<p>
If the build fails at some point,
it is likely that your build tools
are misconfigured or not compatible.

<a name="SimpleTest"><h3>Test the Executable</h3></a>
</p><p>
When the build process completes successfully
it generates an executable CDC Java runtime environment.
The component files of the CDC Java runtime environment
are located in the target build directory.
The most basic runtime files
are in the <tt>bin</tt> and <tt>lib</tt> directories
and a set of demo programs are in <tt>testclasses.zip</tt>.
</p><p>
Here is the command-line for running a simple test application.
</p><p>
</p><blockquote>
<pre>% bin/cvm -cp testclasses.zip HelloWorld
</pre>
</blockquote>

<hr size="1" noshade>
<a name="SimpleFP"><h2>Building Foundation Profile</h2></a>
<p>
Foundation Profile (FP)
is a more complete API specification for headless devices.
The steps described above can be easily modified
to build an executable for FP.
All you have to do is add 
<tt>J2ME_CLASSLIB = foundation</tt> build option
to the build options in the <tt>GNUmakefile</tt>.

<hr size="1" noshade>
<a name="BuildOptions"><h2>More Build Options</h2></a>
</p><p>
The CDC build system includes many build options and targets:
</p><p>
</p><ul>
<li>
<b>API choices.</b>
The Java ME platform has a configurable API architecture
which allows designers to select standardized APIs
that are appropriate for a given target device.
The CDC white paper describes these API choices in more detail.
For now, it's important to understand that these choices
are made available through the build system as build options.
For example,
the choice between which Java ME profile to use
is controlled by the <tt>J2ME_CLASSLIB</tt> build option.
<p>
</p></li><li>
<b>Testing features.</b>
Some build options are intended
only for development and testing purposes.
These include <tt>CVM_TRACE</tt> for tracing VM events
and <tt>CVM_JVMDI</tt> for enabling Java debugging.
<p>
</p></li><li>
<b>Performance features.</b>
And finally, some build options are intended for performance.
For example,
<tt>CVM_PRELOAD_LIB</tt>
uses <tt>JavaCodeCompact</tt> to preload the Java class library
so that it can execute out of ROM.
And <tt>CVM_JIT</tt> builds an executable with a JIT.
</li></ul>
<p>
The <i>CDC Build System Guide</i> provides tables
that describe each build option.

<hr size="1" noshade>
<a name="PBP"><h2>Building Personal Basis Profile</h2></a>
</p><p>
The CDC build system has many <b>build options</b>
for building versions of the CDC Java runtime environment
with additional API capabilities.
For example,
Personal Basis Profile (PBP) is an API specification
for providing GUI capabilities.
While PBP is not itself a GUI framework,
it provides an infrastructure for implementing
lightweight GUI widget toolkits like Swing
and support for the xlet application model.
</p><p>
This build example will show how to build the CDC Java runtime environment
with a PBP implementation based on the
<a href="http://www.trolltech.com/products/qt">Qt</a>
GUI framework.

<a name="PBPSetup"><h3>Setup the Build System</h3></a>
</p><p>
The build system requirements for PBP are the same as the
<a href="/content/pmAdv-buildhost.html#SetupLinuxPackages">base requirements</a>
described earlier with the addition of the Qt3 development libraries.
</p>
<p>
</p><blockquote>
<table cellspacing="10">
<tbody><tr><th colspan="2"><b>Debian</b></th><th colspan="2"><b>RPM</b></th></tr>
<tr><th><b>Package</b></th><th><b>Version</b></th><th><b>Package</b></th><th><b>Version</b></th></tr>
<tr><td><tt>libqt3-compat-headers</tt></td><td>3:3.3.6</td><td><tt>???</tt></td><td>???</td></tr>
<tr><td><tt>libqt3mt-dev</tt></td><td>3:3.3.6</td><td><tt>???</tt></td><td>???</td></tr>
</tbody></table>
</blockquote>

<a name="PBPBuild"><h3>Build the Executable</h3></a>
<p>
Building PBP requires a few additional build options.
You can put these <tt>make</tt> variables
on the <tt>make</tt> command-line
or add them to the <tt>GNUmakefile</tt>.
</p><p>
</p><blockquote>
<pre>J2ME_CLASSLIB = basis
AWT_IMPLEMENTATION = qt
QT_TARGET_DIR = /usr/share/qt3
</pre>
</blockquote>

<a name="PBPTest"><h3>Test the Executable</h3></a>
<p>
Here is the command-line for running a PBP test application.
</p><p>
</p><blockquote>
<pre>% bin/cvm -cp democlasses.jar basis.DemoFrame
</pre>
</blockquote>

<hr size="1" noshade>
<a name="PP"><h2>Building Personal Profile</h2></a>
<p>
Personal Profile (PP) is also an API specification
for providing GUI capabilities.
In fact,
it's a superset of PBP which adds support for AWT and applets.

<a name="PPSetup"><h3>Setup the Build System</h3></a>
</p><p>
The build system requirements for PP are the same as the
<a href="/content/pmAdv-buildhost.html#PBPSetup">build system requirements for PBP</a>
described earlier.

<a name="PPBuild"><h3>Build the Executable</h3></a>
</p><p>
Building PP requires a few additional build options.
You can put these on the <tt>make</tt> command-line
or add them to the <tt>GNUmakefile</tt>.
</p><p>
</p><blockquote>
<pre>J2ME_CLASSLIB = personal
AWT_IMPLEMENTATION = peer_based
QT_TARGET_DIR = /usr/share/qt3
</pre>
</blockquote>

<a name="PPTest"><h3>Test the Executable</h3></a>
<p>
Here is the command-line for running a PP test application.
</p><p>
</p><blockquote>
<pre>% bin/cvm -cp democlasses.jar personal.DemoFrame
</pre>
</blockquote>
</body></html>